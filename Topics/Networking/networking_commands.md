# Networking Commands

## Locating Network Setting and Interfaces

> ls /sys/class/net/
> nmcli dev status 
> nm-connection-editor 
> nmtui
> nmcli connection show
> ls /etc/sysconfig/network-scripts/
> nmcli connection add --help

## Networking and Hostname Resolution Statically or Dynamically: Network Manager

Use tab-tab to display more options when using nmcli
> nmcli connection add con-name "mycon" autoconnect yes type ethernet ifname eth1
> nmcli connection show --active
> vim /etc/sysconfig/network-scripts/ifcfg-mycon
> ip route

```
default via 10.100.36.1 dev ens192 proto dhcp metric 100 
10.100.36.0/24 dev ens192 proto kernel scope link src 10.100.36.84 metric 100 
172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 
172.18.0.0/16 dev br-694d2a8ad241 proto kernel scope link src 172.18.0.1 
192.168.122.0/24 dev virbr0 proto kernel scope link src 192.168.122.1 
```

> nmcli connection add con-name "mycon-static-bridge" type bridge ifname eth1 ip4 10.0.0.180 gw4 10.100.36.1
> nmcli connection up "mycon-static-bridge"
> nmcli connection add con-name "mycon-static-ethernet" type ethernet ifname eth1 ip4 10.0.0.16 gw4 10.100.36.1
> nmcli connection up "mycon-static-ethernet"

Modify connection and start connection on boot
> nmcli connection modify "mycon" connection.autoconnect yes
> nmcli connection delete "mycon"


## Network/Hostname Resolution Statically or Dynamically: Hostname Configuration

- The Name server will resolve the name/ip addr
- The system can be configured to look the /etc/hosts or /etc/resolv.conf first

> vim /etc/nsswitch.conf

``` /etc/nsswitch.conf
#hosts:     db files nisplus nis dns
hosts:      files dns myhostname 
#hosts:      dns files myhostname
```

Can have many server entries
> vim /etc/resolv.conf

``` /etc/resolv.conf
# Generated by NetworkManager
search .com
nameserver 131.92.7.89
nameserver 131.91.205.90
nameserver 131.91.226.20
```

Changing the DNS 

> nmcli connection show
> nmcli connection modify "ens192" ipv4.dns 8.8.8.8
Check the entry on the DNS 8.8.8.8
> cat /etc/sysconfig/network-scripts/ifcfg-ens192

```
# Generated by NetworkManager
search fiu.edu
nameserver 131.94.7.220
nameserver 131.94.205.10
nameserver 131.94.226.10
```

Adding and removing the DNS entries
> nmcli connection modify "ens192" +ipv4.dns 8.8.8.8
> nmcli connection modify "ens192" -ipv4.dns 8.8.8.8

Get entries from Name Service Switch libraries
> getent hosts  www.google.com

## DNS poisoning

WARNGING: DNS poisoning, causing the name server to return an incorrect result record, e.g. an IP address.
> vim /etc/hosts
Example

- aws-server.us.com should be 172.1.1.18
- we make a change in /etc/hosts
- make sure the /etc/nsswitch.conf checks for internal hosts then the dns
- make sure the /etc/resolv.conf has been configured to point a dns server

``` /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
10.0.0.0    aws-server.us.com
```

## IMCP


## Gateway Information

> route
> route -n

The flag U indicates that route is up and G indicates that it is gateway. 

``` $ route -n
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         134.209.160.1   0.0.0.0         UG    0      0        0 eth0
10.17.0.0       0.0.0.0         255.255.0.0     U     0      0        0 eth0
```


> netstat -r -n
> ip route

ip is a very powerful program that can do many things. Older (and more specific) utilities such as ifconfig and route are often used to accomplish similar tasks.
> ip
> ifconfig
> iptables
ping is used to check whether or not a machine attached to the network can receive and send data; i.e. it confirms that the remote host is online and is responding.
> ping





## Trace path to a network host discovering MTU along this path

- tracepath
- tracepath6
- traceroute
- traceroute6

traceroute is used to inspect the route which the data packet takes to reach the destination host, which makes it quite useful for troubleshooting network delays and errors.
> traceroute
Queries network interfaces and can also set various parameters such as the speed
> ethtool
Displays all active connections and routing tables. Useful for monitoring performance and troubleshooting
> netstat
Scans open ports on a network. Important for security analysis
> nmap
Dumps network traffic for analysis
> tcpdump
Monitors network traffic in text mode
> uptraf
Combines functionality of ping and traceroute and gives a continuously updated display
> mtr

## Tests DNS workings. A good replacement for host and nslookup

> dig
> wget
> curl
> sftp
> scp
> nmtui
> nmcli
> route

Older ip address and hostname resolver
> nslookup
> host server.fiu.edu
> dhclient
> hostnamectl


## Investigate sockets

- ss


## Trouble shooting

> nc -vz code42.example.com 443
> telnet code42.example.com 443

https://support.code42.com/CrashPlan/5/Troubleshooting/Test_your_network_connection

Resources:

Connecting to VM
https://www.youtube.com/watch?v=8V4Ez4NUHAk


https://www.serverlab.ca/tutorials/linux/administration-linux/how-to-configure-centos-7-network-settings/

ARP
`arp -s hostname hw_addr`
http://users.cs.fiu.edu/~esj/cgs4285/class11.html

Bridging the Virtual Box machine with the host
https://coderwall.com/p/yx23qw/access-your-virtualbox-guest-localhost-from-your-host-os


3 Ways to Find Out Which Process Listening on a Particular Port
https://www.tecmint.com/find-out-which-process-listening-on-a-particular-port/
